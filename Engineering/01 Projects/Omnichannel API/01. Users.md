
---

## Status: Pending  
Thumbnail: "#64B5F6"  
Description: User Identity, Profile & Document Management  
Application: Retail Engine  
Due On: 2025-10-12T12:00:00

---

## Overview

The **User Management Module** handles the complete lifecycle of user accounts in the digital banking platform.

It manages user onboarding, identity verification, profile management, document uploads, and messaging, integrating with Identity, CBA, CRM, and various processors to ensure secure, compliant, and seamless user experiences.

---

## Core Business Functions

- **User Onboarding** â€“ Register new users and onboard existing account holders.
- **Identity Verification** â€“ Verify user identity using country-specific documents (BVN, NIN, SSN, VIN).
- **Profile Management** â€“ View and update user profile information and attributes.
- **Document Management** â€“ Handle compliance documents, identity documents, and profile pictures.
- **Communication** â€“ Send verification codes, welcome messages, and manage user notifications.
- **Email Verification** â€“ Validate user email address ownership.

---

## Technical Dependencies

### Adapter & Processor Dependencies

|Adapter / Processor|Business Purpose|
|---|---|
|Identity Adapter|Manages user accounts, authentication, verification codes, and email validation.|
|CBA Adapter|Creates and manages client accounts, savings accounts, and compliance documents in Core Banking.|
|CRM Adapter|Synchronizes partner/customer profiles and manages user messages.|
|Util Worker (Messages)|Sends OTPs, welcome messages, verification emails, and notifications.|
|Processor (Payments)|Creates virtual accounts for payment processing.|
|Processor (Identity)|Validates identity documents and compliance status.|
|Processor (Documents)|Stores and retrieves compliance documents, ID documents, and profile images.|
|User Settings Utility|Applies user-specific message and notification preferences.|

---

## REST Endpoints

### User Management APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|US001|Onboard New User|/users/profile|POST|â€”|ğŸ”„|
|US002|Lookup Existing User|/users/profile/by/{accountNo}|GET|â€”|ğŸ”„|
|US003|Onboard Existing User|/users/profile/by/{accountNo}|POST|â€”|ğŸ”„|
|US004|Trigger Identity Verification|/users/identity/lookup|POST|â€”|ğŸ”„|
|US005|Resend Verification Code|/users/identity/resend-code|POST|â€”|ğŸ”„|
|US006|Confirm Identity Verification|/users/identity/confirm|POST|â€”|ğŸ”„|
|US007|Upload Compliance Documents|/users/documents/compliance|POST|â€”|ğŸ”„|
|US008|Upload Identity Documents|/users/documents/identification|POST|â€”|ğŸ”„|
|US009|Upload Profile Picture|/users/profile/avatar|POST|â€”|ğŸ”„|
|US010|Trigger Email Verification|/users/email/verify|POST|â€”|ğŸ”„|
|US011|View User Profile|/users/profile/my|GET|â€”|ğŸ”„|
|US012|View User Avatar|/users/profile/avatar|GET|â€”|ğŸ”„|
|US013|Update User Attributes|/users/claims/my|PUT|â€”|ğŸ”„|
|US014|List User Messages|/users/messages|GET|â€”|ğŸ”„|
|US015|Delete User Message|/users/messages/{messageId}|DELETE|â€”|ğŸ”„|

---

## Dependency Service APIs

### 1. Identity Adapter APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|AI001|Create User in Identity System||POST|US001|ğŸ”„|
|AI002|Create User in Identity System||POST|US003|ğŸ”„|
|AI003|Create OTP Code||POST|US004|ğŸ”„|
|AI004|Generate New Verification Code||POST|US005|ğŸ”„|
|AI005|Validate OTP Code||POST|US006|ğŸ”„|
|AI006|Update User Verification Status||POST|US006|ğŸ”„|
|AI007|Create Email Verification Challenge||POST|US010|ğŸ”„|
|AI008|Fetch User Identity Profile||GET|US011|ğŸ”„|
|AI009|Update Identity Claims||PUT|US013|ğŸ”„|

---

### 2. CBA Adapter APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|CB001|Create Client in CBA||POST|US001|ğŸ”„|
|CB002|Fetch Client CBA Account Data||GET|US002|ğŸ”„|
|CB003|Create Default Saving Account||POST|US006|ğŸ”„|
|CB004|Create OTP Code for Client Claim (Datatable)||POST|US003|ğŸ”„|
|CB005|Update Client Compliance Status||POST|US007|ğŸ”„|
|CB006|Update Client KYC Document Status||POST|US008|ğŸ”„|
|CB007|Update Client Avatar Reference URL||POST|US009|ğŸ”„|
|CB008|Fetch Client CBA Account Profile||GET|US011|ğŸ”„|
|CB009|Update Client Profile in CBA||PUT|US013|ğŸ”„|

---

### 3. CRM Adapter APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|CR001|Create Partner in CRM||POST|US001|ğŸ”„|
|CR002|Update Client CRM Data||POST|US006|ğŸ”„|
|CR003|Create Partner in CRM||POST|US003|ğŸ”„|
|CR004|Fetch Partner CRM Profile||GET|US011|ğŸ”„|
|CR005|Update Partner Profile in CRM||PUT|US013|ğŸ”„|
|CR006|Fetch User Messages||GET|US014|ğŸ”„|
|CR007|Mark Message as Deleted||DELETE|US015|ğŸ”„|

---

### 4. Notification Worker APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|UM001|Send Welcome Message||POST|US001|ğŸ”„|
|UM002|Send OTP to User||POST|US003|ğŸ”„|
|UM003|Send Welcome Message||POST|US003|ğŸ”„|
|UM004|Send OTP/Verification Code||POST|US004|ğŸ”„|
|UM005|Resend OTP for Message Not Received||POST|US005|ğŸ”„|
|UM006|Send Verification Success Message||POST|US006|ğŸ”„|
|UM007|Send Verification Email||POST|US010|ğŸ”„|

---

### 5. Document Processor APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|PD001|Process & Store Compliance Documents||POST|US007|ğŸ”„|
|PD002|Process & Store ID Document||POST|US008|ğŸ”„|
|PD003|Process & Store Image||POST|US009|ğŸ”„|
|PD004|Serve Image File||GET|US012|ğŸ”„|

---

### 6. Identity Processor APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|PI001|Verify Identity Status & Compliance||POST|US004|ğŸ”„|

---

### 7. Payment Processor APIs

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|PP001|Create Virtual Account||POST|US006|ğŸ”„|

---

### 8. User Settings Utility

|**Action**|**Summary**|**Route**|**Method**|**Operation ID**|**Status**|
|---|---|---|---|---|---|
|SU001|Apply Message Settings||GET|US014|ğŸ”„|

---

## Security and Governance

### Permissions & APIs

|**Permission**|**Permission Name**|**APIs**|**Status**|
|---|---|---|---|
|user_create|Create User Accounts|US001, US003|ğŸ”„|
|user_view|View User Information|US002, US011, US012, US014|ğŸ”„|
|user_update|Update User Profile|US013|ğŸ”„|
|user_verify|Verify User Identity|US004, US005, US006, US010|ğŸ”„|
|user_docs|Manage User Documents|US007, US008, US009|ğŸ”„|
|user_messages|Manage User Messages|US014, US015|ğŸ”„|

---

### Roles & Permissions

|**Role**|**Role Name**|**Permissions**|**Status**|
|---|---|---|---|
|RP101|System Administrator|user_create, user_view, user_update, user_verify, user_docs, user_messages|ğŸ”„|
|RP102|Customer Support|user_view, user_verify, user_messages|ğŸ”„|
|RP103|KYC Officer|user_view, user_verify, user_docs|ğŸ”„|
|RP104|Standard User (Self)|user_view, user_update, user_verify, user_docs, user_messages|ğŸ”„|

---

### Policies & Attributes

|**Policy ID**|**Policy**|**Attribute / Condition**|**Status**|
|---|---|---|---|
|P_USER_001|Users can only view and update their own profile|`user.id eq authenticated_user.id`|ğŸ”„|
|P_USER_002|Identity verification requires valid session|`identity.session.valid eq true`|ğŸ”„|
|P_USER_003|Document uploads require KYC permissions|`role in ["RP103", "RP104"]`|ğŸ”„|
|P_USER_004|User creation requires system admin role|`role in ["RP101"]`|ğŸ”„|
|P_USER_005|Message deletion limited to message owner|`message.owner_id eq user.id`|ğŸ”„|

---

### Related Documents

1. **User Onboarding Process Guide**
2. **Identity Verification Standards**
3. **KYC/AML Compliance Requirements**
4. **Document Upload Specifications**
5. **CBA Integration Schema**

---

âœ… - Complete  
ğŸ”„ - In Progress  
â° - Delayed  
ğŸš§ - In Testing  
âš ï¸ - Comments from Testing  
â›” - Failed Testing  
ğŸ“‹ - Planned for future release