
**Status:** In Progress  
**Thumbnail:** `#6A9BFF`  
**Description:** User onboarding, identity, compliance & profile management  
**Application:** Retail Engine  
**Due On:** 2025-10-20T12:00:00

---

## Overview

The **Users Module** manages the full lifecycle of a platform userâ€”identity creation, document verification, compliance handling, account creation, messaging, and profile maintenance.

It provides the foundational user identity layer used across all ADIBA-powered financial institutions.

---

## Core Business Functions

- **User Onboarding & Identity Creation**  
- **Identity Verification (BVN/NIN, Codes, Sessions)**  
- **Compliance & ID Document Processing**  
- **User Profile Read & Update**  
- **User Messaging & Notifications**  
- **User Preferences & Environment Settings**

---

## Technical Dependencies

| Component                      | Business Purpose                               |
| ------------------------------ | ---------------------------------------------- |
| **Identity Processor**         | Validation, verification workflow, sessions    |
| **Identity Adapter**           | Manage identity records and claims             |
| **Core Banking Adapter (CBA)** | Create bank accounts, retrieve account data    |
| **Payments Processor**         | Initialize payment instruments                 |
| **CRM Adapter**                | Sync CRM contact details                       |
| **Messages Worker**            | Sends notifications, OTPs, verification emails |
| **Documents Processor**        | Processes and stores user documents            |
| **User Settings Utility**      | Manages user preferences and settings          |

---
##  REST Endpoints

| **Code** | **Summary** | **Route** | **Method** | **External ID** | **Status** |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **US001** | Onboard New User | /users/profile | POST | createUserIdentity | ðŸ”„ |
| **US002** | Lookup Existing User | /users/profile/by/{accountNo} | GET | lookupUserIdentity | ðŸ”„ |
| **US003** | Onboard Existing User (Create Bank Account) | /users/profile/by/{accountNo} | POST | completeBankAccountCreation | ðŸ”„ |
| **US004** | Trigger Identity Verification | /users/identity/lookup | POST | verifyIdentityDocuments | ðŸ”„ |
| **US005** | Resend Verification Code | /users/identity/resend-code | POST | resendVerificationCode | ðŸ”„ |
| **US006** | Confirm Identity Verification | /users/identity/confirm | POST | confirmIdentityVerification | ðŸ”„ |
| **US007** | Upload Compliance Document | /users/documents/compliance | POST | uploadComplianceDocument | ðŸ”„ |
| **US008** | Upload Identity Document | /users/documents/identification | POST | uploadIdentityDocument | ðŸ”„ |
| **US009** | Upload Profile Picture | /users/profile/avatar | POST | uploadProfilePicture | ðŸ”„ |
| **US010** | Trigger Email Verification | /users/email/verify | POST | triggerEmailVerification | ðŸ”„ |
| **US011** | View User Profile | /users/profile/my | GET | viewUserProfile | ðŸ”„ |
| **US012** | View User Avatar | /users/profile/avatar | GET | viewUserAvatar | ðŸ”„ |
| **US013** | Update User Attributes | /users/claims/my | PUT | updateUserAttributes | ðŸ”„ |
| **US014** | List User Messages | /users/messages | GET | listUserMessages | ðŸ”„ |
| **US015** | Delete User Message | /users/messages/{message_id} | DELETE | deleteUserMessage | ðŸ”„ |

---

# Component Interactions (Adapter & Processor APIs)

## 1. Identity Processor APIs

---

## 2. Identity Adapter APIs

| Action    | Summary                                  | Route                                         | Method    | External ID          | Operation ID(s) | Status |
| --------- | ---------------------------------------- | --------------------------------------------- | --------- | -------------------- | --------------- | ------ |
| **IA001** | Create User in Identity System           | `/users/profile`                              | POST      | EXT-US001            | US001           | ðŸ”„     |
| **IA002** | Fetch Identity Data                      | `/users/profile/by/{accountNo}`               | GET       | EXT-US002            | US002           | ðŸ”„     |
| **IA003** | Update Identity Claims / Verify Identity | `/users/identity/confirm`, `/users/claims/my` | POST, PUT | EXT-US006, EXT-US013 | US006, US013    | ðŸ”„     |
| **IA004** | Fetch Identity Profile                   | `/users/profile/my`                           | GET       | EXT-US011            | US011           | ðŸ”„     |
| **IA005** | Store Verification Session               | `/users/identity/lookup`                      | POST      | EXT-US004            | US004           | ðŸ”„     |
| **IA006** | Generate Email Verification Token        | `/users/email/verify`                         | POST      | EXT-US010            | US010           | ðŸ”„     |

---

## 3. Core Banking Adapter (CBA) APIs

|Action|Summary|Route|Method|External ID|Operation ID(s)|Status|
|---|---|---|---|---|---|---|
|**CB001**|Create Client in CBA||POST|EXT-US001|US001|ðŸ”„|
|**CB002**|Fetch Client CBA Account Data||GET|EXT-US002|US002|ðŸ”„|
|**CB003**|Update Client Profile in CBA||PUT|EXT-US006, EXT-US013|US006, US013|ðŸ”„|
|**CB004**|Update Client Compliance Status||POST|EXT-US007|US007|ðŸ”„|
|**CB005**|Update Client KYC Document Status||POST|EXT-US008|US008|ðŸ”„|
|**CB006**|Update Client Avatar Reference URL||POST|EXT-US009|US009|ðŸ”„|
|**CB007**|Fetch Client Account Status||GET|EXT-US011|US011|ðŸ”„|

---

I

---

## 4. Payments Processor APIs

|Action|Summary|Route|Method|External ID|Operation ID(s)|Status|
|---|---|---|---|---|---|---|
|**PP001**|Initialize Payment Methods|`/users/profile/by/{accountNo}`|POST|EXT-US003|US003|ðŸ”„|

---

## 5. CRM Adapter APIs

|Action|Summary|Route|Method|External ID|Operation ID(s)|Status|
|---|---|---|---|---|---|---|
|**CR001**|Create Partner Record|`/users/profile`|POST|EXT-US001|US001|ðŸ”„|
|**CR002**|Update CRM with Account Details|`/users/profile/by/{accountNo}`|POST|EXT-US003|US003|ðŸ”„|
|**CR003**|Fetch CRM Data|`/users/profile/my`|GET|EXT-US011|US011|ðŸ”„|
|**CR004**|Update CRM Record|`/users/claims/my`|PUT|EXT-US013|US013|ðŸ”„|

---

## 6. Messages Worker APIs

|Action|Summary|Route|Method|External ID|Operation ID(s)|Status|
|---|---|---|---|---|---|---|
|**MW001**|Send Welcome message|`/users/profile`|POST|EXT-US001|US001|ðŸ”„|
|**MW002**|Send Verification Code / OTP|`/users/identity/lookup`|POST|EXT-US004|US004|ðŸ”„|
|**MW003**|Resend SMS/Email with Code|`/users/identity/resend-code`|POST|EXT-US005|US005|ðŸ”„|
|**MW004**|Send Verification Success Message|`/users/identity/confirm`|POST|EXT-US006|US006|ðŸ”„|
|**MW005**|Send Email Verification|`/users/email/verify`|POST|EXT-US010|US010|ðŸ”„|
|**MW006**|Fetch User Messages|`/users/messages`|GET|EXT-US014|US014|ðŸ”„|
|**MW007**|Mark Message as Deleted / Notify|`/users/messages/{message_id}`|DELETE|EXT-US015|US015|ðŸ”„|

---

## 7. Documents Processor APIs

|Action|Summary|Route|Method|External ID|Operation ID(s)|Status|
|---|---|---|---|---|---|---|
|**DP001**|Process & Store Compliance Documents|`/users/documents/compliance`|POST|EXT-US007|US007|ðŸ”„|
|**DP002**|Process & Store ID Documents|`/users/documents/identification`|POST|EXT-US008|US008|ðŸ”„|
|**DP003**|Process & Store Profile Image|`/users/profile/avatar`|POST|EXT-US009|US009|ðŸ”„|
|**DP004**|Serve Image File|`/users/profile/avatar`|GET|EXT-US012|US012|ðŸ”„|

---

## 8. User Settings Utility APIs

| Action     | Summary                    | Route                           | Method | External ID | Operation ID(s) | Status |
| ---------- | -------------------------- | ------------------------------- | ------ | ----------- | --------------- | ------ |
| **USU001** | Set Basic User Preferences | `/users/profile`                | POST   | EXT-US001   | US001           | ðŸ”„     |
| **USU002** | Set Banking Preferences    | `/users/profile/by/{accountNo}` | POST   | EXT-US003   | US003           | ðŸ”„     |
| **USU003** | Apply User Settings        | `/users/profile/my`             | GET    | EXT-US011   | US011           | ðŸ”„     |
| **USU004** | Apply Message Settings     | `/users/messages`               | GET    | EXT-US014   | US014           | ðŸ”„     |
|            |                            |                                 |        |             |                 |        |

---

Y

# Security & Governance

## Permissions & APIs

| Permission | Name | APIs | Status |
|------------|-------|--------|--------|
| **usr_onboard** | Onboard Users | US001â€“US010 | ðŸ”„ |
| **usr_read** | View Profiles | US011â€“US012 | ðŸ”„ |
| **usr_update** | Update Profiles | US013 | ðŸ”„ |
| **usr_messages** | Manage Messages | US014â€“US015 | ðŸ”„ |
| **usr_docs** | Upload Documents | US007â€“US009 | ðŸ”„ |

---

## Roles & Permissions

| Role | Name | Permissions | Status |
|-------|---------|----------------|--------|
| **UR001** | Administrator | usr_onboard, usr_update, usr_docs, usr_messages | ðŸ”„ |
| **UR002** | Onboarding Officer | usr_onboard, usr_docs | ðŸ”„ |
| **UR003** | Customer Service | usr_read, usr_messages | ðŸ”„ |
| **UR004** | Compliance Officer | usr_read, usr_docs | ðŸ”„ |

---

## Policies & Attributes

| Policy ID | Policy | Condition | Status |
|-----------|--------|-----------|--------|
| **P_USR_001** | Org MUST have active RE Subscription | `org.apps.retail eq active` | ðŸ”„ |
| **P_USR_002** | Users can ONLY update their own profile | `subject.id eq user.id` | ðŸ”„ |

---

## Related Documents

1. Identity Verification Framework  
2. Customer Lifecycle & Compliance Model  
3. Messaging Templates â€“ User Onboarding
