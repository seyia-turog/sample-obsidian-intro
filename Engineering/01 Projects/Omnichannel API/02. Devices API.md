---
Status: Pending  
Thumbnail: "#FFCC80"  
Description: Device Enrollment, Security & PIN Management Services  
Application: Retail Engine  
Due On: 2025-10-09T12:00:00  
---

---

## Overview

The **Device Management Module** provides secure device lifecycle operations within the ADIBA ecosystem.  
It covers enrollment, certificate handling, ownership transfer, and PIN management to ensure devices remain trusted and compliant.

The module integrates tightly with Identity, CRM, Certificates Authority (CA), and notification workers to maintain device integrity and enforce security policies.

---

### Core Business Functions

- **Device Enrollment & Status Tracking** â€“ Register devices and monitor activation status.  
- **Certificate Lifecycle Management** â€“ Generate, sign, rotate, and validate device certificates.  
- **Device Ownership Control** â€“ Securely transfer device ownership between users.  
- **PIN Management** â€“ Create, update, reset, and confirm secure PINs.  
- **Security Notifications** â€“ Alert users of device and PIN changes.  

---

## Technical Dependencies

### Adapter & Processor Dependencies

| Adapter / Processor | Business Purpose |
| -------------------- | ---------------- |
| Identity Adapter     | Validates device identity, user credentials, and CA token interactions. |
| CRM Adapter          | Updates device assignments and synchronizes ownership transfers. |
| Util Worker (Messages) | Sends device and PIN change notifications. |
| User Settings Utility | Updates device preferences and security configurations. |

---

## REST Endpoints

### 1. Device Management APIs

| **Action** | **Summary**                  | **Route**                       | **Method** | **Status** |
| ----------- | ---------------------------- | -------------------------------- | ---------- | ---------- |
| DEV001      | Check Device Status          | /devices/enrollment/status       | GET        | ğŸ”„ |
| DEV002      | (de)Activate Device          | /devices/enrollment/status       | POST       | ğŸ”„ |
| DEV003      | Submit CSR for Device        | /devices/certificate/request     | POST       | ğŸ”„ |
| DEV004      | Sign CSR for Device          | /devices/certificate/sign        | POST       | ğŸ”„ |
| DEV005      | Rotate Expiring Certificates | /devices/certificate/rotate      | POST       | ğŸ”„ |
| DEV006      | Transfer Device Ownership    | /devices/ownership/transfer      | POST       | ğŸ”„ |
| DEV007      | Accept Ownership Transfer    | /devices/ownership/accept        | POST       | ğŸ”„ |
| DEV008      | Create Device PIN            | /devices/pin/my                 | POST       | ğŸ”„ |
| DEV009      | Change Device PIN            | /devices/pin/change              | POST       | ğŸ”„ |
| DEV010      | Reset Device PIN             | /devices/pin/reset               | POST       | ğŸ”„ |
| DEV011      | Confirm PIN Reset            | /devices/pin/confirm             | POST       | ğŸ”„ |

---

### 2. Identity Adapter APIs

| **Action** | **Summary**                    | **Route** | **Method** | **Operation ID** | **Status** |
| ----------- | ------------------------------ | --------- | ---------- | ---------------- | ---------- |
| IA001       | Validate Device Enrollment     |           | POST       | DEV003           | ğŸ”„ |
| IA002       | Validate CA Token              |           | POST       | DEV004           | ğŸ”„ |
| IA003       | Validate Current PIN           |           | POST       | DEV009           | ğŸ”„ |
| IA004       | Validate Reset Token           |           | POST       | DEV011           | ğŸ”„ |

---

### 3. CRM Adapter APIs

| **Action** | **Summary**                  | **Route** | **Method** | **Operation ID** | **Status** |
| ----------- | ---------------------------- | --------- | ---------- | ---------------- | ---------- |
| CRM001      | Update Device Assignment     |           | POST       | DEV007           | ğŸ”„ |
| CRM002      | Sync Ownership Transfer      |           | POST       | DEV006, DEV007   | ğŸ”„ |

---

### 4. Notification Worker APIs

| **Action** | **Summary**                           | **Route** | **Method** | **Operation ID** | **Status** |
| ----------- | ------------------------------------- | --------- | ---------- | ---------------- | ---------- |
| MSG001      | Send Device Status Change Notice       |           | POST       | DEV002           | ğŸ”„ |
| MSG002      | Send Certificate Rotation Notice       |           | POST       | DEV005           | ğŸ”„ |
| MSG003      | Send Transfer Completion Notification  |           | POST       | DEV007           | ğŸ”„ |
| MSG004      | Send PIN Change Confirmation           |           | POST       | DEV009           | ğŸ”„ |
| MSG005      | Send PIN Reset Token                   |           | POST       | DEV010           | ğŸ”„ |
| MSG006      | Send PIN Reset Completion Notice       |           | POST       | DEV011           | ğŸ”„ |

---

### 5. User Settings Utility

| **Action** | **Summary**                | **Route** | **Method** | **Operation ID** | **Status** |
| ----------- | -------------------------- | --------- | ---------- | ---------------- | ---------- |
| US001       | Update Device Preferences  |           | PUT        | DEV002           | ğŸ”„ |
| US002       | Update Security Settings   |           | PUT        | DEV011           | ğŸ”„ |

---

## Security and Governance

### Permissions & APIs

| **Permission** | **Permission Name**         | **APIs**                 | **Status** |
| --------------- | --------------------------- | ------------------------- | ---------- |
| dev_view        | View Device Status          | DEV001                   | ğŸ”„ |
| dev_manage      | Device Activation & CSR Ops | DEV002, DEV003, DEV004   | ğŸ”„ |
| dev_security    | PIN & Certificate Security  | DEV005â€“DEV011            | ğŸ”„ |

---

### Roles & Permissions

| **Role** | **Role Name**        | **Permissions**                    | **Status** |
| -------- | --------------------- | ---------------------------------- | ---------- |
| RP001    | System Admin          | dev_view, dev_manage, dev_security | ğŸ”„ |
| RP002    | Device Officer        | dev_view, dev_manage               | ğŸ”„ |
| RP003    | General User          | dev_view                           | ğŸ”„ |

---

### Policies & Attributes

| **Policy ID** | **Policy**                                      | **Attribute / Condition**          | **Status** |
| -------------- | ------------------------------------------------ | ----------------------------------- | ---------- |
| P_DEV_001      | Only verified users can activate devices         | `identity.verified eq true`         | ğŸ”„ |
| P_DEV_002      | Only owner can modify PIN                        | `device.owner_id eq user.id`        | ğŸ”„ |
| P_DEV_003      | Device certificate operations require clearance  | `role in ["RP001","RP002"]`         | ğŸ”„ |

---

### Related Documents

1. **Device Enrollment & Certificate Workflow Guide**  
2. **Identity Integration for Trusted Devices**  
3. **CRM Device Assignment Schema**

---

âœ… - Complete  
ğŸ”„ - In Progress  
â° - Delayed  
ğŸš§ - In Testing  
âš ï¸ - Comments from Testing  
â›” - Failed Testing  
ğŸ“‹ - Planned for future release
